let packageLocation="./js-packages/gallery",gallery=null,galleryContainer=null,galleryItems=null,filters=new Set,filterItems=null,activeFilter=0,filteredItems=[],modal=null,modalContainer=null,activeModalItem=0;function setGallery(e){loadCSS(),(gallery=e).classList.add("gallery");let t=[].slice.call(gallery.children);galleryContainer=setContainerElement(gallery,"gallery-container"),setItemsAndFilters(t),displayFilters(),setFilterListeners(),setGalleryItemsListeners(),(modal=document.createElement("dialog")).classList.add("modal"),document.body.appendChild(modal),modalContainer=setContainerElement(modal,"modal-container"),setModalButtons(),setCloseListeners()}function loadCSS(){if(!document.getElementById("galleryCSS")){let e=document.createElement("link");e.rel="stylesheet",e.href="./js-packages/gallery/styles/gallery-style.css",e.type="text/css",e.id="galleryCSS",document.head.appendChild(e),console.error("Le CSS de la gallery n'a pas \xe9t\xe9 charg\xe9 initialement et a d\xfb l'\xeatre par le script.\nN'oublie pas de rajouter la balise Link"),console.error(e)}}function setContainerElement(e,t){let l=document.createElement("div");return l.className=t,e.appendChild(l),l}function setItemsAndFilters(e){filters.add("Tous"),galleryItems=e.map(e=>{let t=document.createElement("div");return t.className="gallery-item",t.setAttribute("data-gallery",e.getAttribute("data-gallery")),filters.add(e.getAttribute("data-gallery")),e.removeAttribute("data-gallery"),t.appendChild(e),galleryContainer.appendChild(t),t});for(let t=0;t<galleryItems.length;t++)filteredItems.push([t,galleryItems[t]])}function displayFilters(){let e=document.createElement("ul");e.className="filter-container",filters.forEach(t=>{let l=document.createElement("li");l.className="filter-item",l.innerHTML=t,e.appendChild(l)}),gallery.insertBefore(e,gallery.firstChild),(filterItems=e.children)[0].classList.add("active")}function setFilterListeners(){for(let e=0;e<filterItems.length;e++)filterItems[e].addEventListener("click",()=>{filteredItems=[];for(let t=0;t<galleryItems.length;t++)filterItems[e].innerHTML===galleryItems[t].getAttribute("data-gallery")||"Tous"===filterItems[e].innerHTML?(galleryItems[t].removeAttribute("style"),filteredItems.push([t,galleryItems[t]])):galleryItems[t].style.display="None";filterItems[activeFilter].classList.remove("active"),filterItems[e].classList.add("active"),activeFilter=e})}function setGalleryItemsListeners(){for(let e=0;e<galleryItems.length;e++)galleryItems[e].addEventListener("click",()=>{displayModal(e)})}function setModalButtons(){for(let e=0;e<2;e++){let t=document.createElement("button");t.className="modal-button",t.type="button",t.innerHTML="^",0===e?(t.classList.add("modal-left-button"),t.ariaLabel="Pr\xe9c\xe9dent",t.addEventListener("click",e=>{e.stopPropagation(),changeModalPic(-1)})):(t.classList.add("modal-right-button"),t.ariaLabel="Suivant",t.addEventListener("click",e=>{e.stopPropagation(),changeModalPic(1)})),modal.appendChild(t)}}function displayModal(e){modalContainer.innerHTML="",modalContainer.appendChild(galleryItems[e].firstChild.cloneNode(!0)),activeModalItem=e,modal.showModal()}function changeModalPic(e){let t=!1;for(;!t;){(activeModalItem+=e)<0&&(activeModalItem=galleryItems.length-1),activeModalItem===galleryItems.length&&(activeModalItem=0);for(let l=0;l<filteredItems.length;l++)if(filteredItems[l][0]===activeModalItem){modalContainer.innerHTML="",modalContainer.appendChild(galleryItems[activeModalItem].firstChild.cloneNode(!0)),t=!0;break}}}function setCloseListeners(){modal.addEventListener("click",e=>{e.preventDefault(),modal.close()}),modalContainer.addEventListener("click",e=>{e.stopPropagation()})}export{setGallery};